<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.rzhd.wuye.mapper.RentContractMapper">

	<select id="getAll"  resultMap="RentContractBackMap">
		SELECT
			P.PROJECT_NAME,
			r."house",
			c."vcname",
			r."dpactstart",
			r."dpactend",
			r."dysdate",
			r."nsbzjyjmny",
			r."nhtssmny",
			r."nzlbzjmny",
			r."nhtysmny"
		FROM
			"T_Rent_Contract" r
		LEFT JOIN T_PROJECT_INFO P ON r."pk_project" = P .PK_PROJECT
		LEFT JOIN "T_Customer" c ON r."pk_customerid" = c."pk_customerid"
	</select> 
	
	<resultMap type="cn.rzhd.wuye.vo.PactVO" id="RentContractBackMap">
		<id property="pk_project" column="pk_project"/>
		<result property="house" column="house"/>
    	<result property="dpactend" column="dpactend"/>
    	<result property="dpactstart" column="dpactstart"/>
    	<result property="nzlbzjmny" column="nzlbzjmny"/>
    	<result property="nhtysmny" column="nhtysmny"/>
    	<result property="nhtssmny" column="nhtssmny"/>
    	<result property="dysdate" column="dysdate"/>
    	<result property="nsbzjyjmny" column="nsbzjyjmny"/>
		<association property="customerVO" javaType="cn.rzhd.wuye.vo.CustomerVO">
			<id property="pk_customerid" column="pk_customerid" />
			<result property="vcname" column="vcname" />
	 	</association>
	 	<association property="projectVO" javaType="cn.rzhd.wuye.vo.ProjectVO">
			<id property="pk_project" column="PK_PROJECT" />
			<result property="vname" column="PROJECT_NAME" />
	 	</association>
	</resultMap>
	
	
	

    <select id="getByPkId" parameterType="String" resultMap="rentContractMap">
        SELECT
            "pk_corp",
            "pk_customerid",
            "pk_project",
            "pk_pact",
            "pk_house",
            "house",
            "nrentarea",
            "dpactend",
            "dpactstart",
            "nzlbzjmny",
            "nhtysmny",
            "nhtssmny",
            "dysdate",
            "nsbzjyjmny"
        FROM "T_Rent_Contract"
        WHERE "pk_pact" = #{pk_pact}
    </select>
    <resultMap type="cn.rzhd.wuye.vo.PactVO" id="rentContractMap">
        <id property="pk_pact" column="pk_pact"/>
        <result property="house" column="house"/>
        <result property="nrentarea" column="nrentarea"/>
        <result property="dpactend" column="dpactend"/>
        <result property="dpactstart" column="dpactstart"/>
        <result property="nzlbzjmny" column="nzlbzjmny"/>
        <result property="nhtysmny" column="nhtysmny"/>
        <result property="nhtssmny" column="nhtssmny"/>
        <result property="dysdate" column="dysdate"/>
        <result property="nsbzjyjmny" column="nsbzjyjmny"/>


    </resultMap>

    <select id="queryByCustomer" parameterType="string" resultType="cn.rzhd.wuye.vo.PactVO">
        SELECT DISTINCT
            "pk_house",
            "house",
            "pk_project",
            SERVICE_PHONE,
            OBJECT_PHONE,
            "pk_customerid",
            p.VSHORTNAME AS projectName
        FROM "T_Rent_Contract"
            JOIN T_PROJECT_INFO p ON "pk_project" = p.PK_PROJECT
        WHERE "pk_customerid" = #{customerId}
    </select>

    <insert id="add" parameterType="cn.rzhd.wuye.vo.PactVO">
        INSERT INTO "T_Rent_Contract" ("pk_corp",
                                       "pk_customerid",
                                       "pk_project",
                                       "pk_pact",
                                       "pk_house",
                                       "house",
                                       "nrentarea",
                                       "dpactend",
                                       "dpactstart",
                                       "nzlbzjmny",
                                       "nhtysmny",
                                       "nhtssmny",
                                       "dysdate",
                                       "nsbzjyjmny"
        )
        VALUES (#{pk_corp}, #{pk_customerid}, #{pk_project}, #{pk_pact}, #{pk_house}, #{house}, #{nrentarea},
                            #{dpactend}, #{dpactstart}, #{nzlbzjmny}, #{nhtysmny}, #{nhtssmny},
                #{dysdate}, #{nsbzjyjmny})
    </insert>

</mapper>